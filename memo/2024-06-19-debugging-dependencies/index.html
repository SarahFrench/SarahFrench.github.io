<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><style>@import 'https://fonts.googleapis.com/css2?family=VT323&display=swap'</style><link rel=stylesheet href=https://sarahfrench.dev/sass/main.css><base href=https://sarahfrench.dev/><script>document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#menu"),t=new IntersectionObserver((e)=>{console.log("callback fired");const n=e[0];n.target.classList.toggle("nav--pinned",n.intersectionRatio<1)},{threshold:[1]});t.observe(e)})</script><title>How to debug dependencies in Go projects | Sarah French</title></head><body><nav id=menu class=nav><a class=nav-link href=/ title>Home
</a><a class=nav-link href=/blog title>Blog
</a><a class=nav-link href=/memo title>Memos
</a><a class=nav-link href=/project title>Projects</a></nav><svg class="hero hero--subpage" width="100%" height="100%" viewBox="0 0 800 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5"><g transform="matrix(1,0,0,1,1,-196.312)"><g transform="matrix(1,0,0,0.506741,0,197.407)"><rect x="-.829" y="-2.161" width="801.197" height="402.37" style="fill:#12022d"/></g><g id="veticals"><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M393.82 194.416 393.843 399.466" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M416.82 194.418c17.341 68.353 52.023 205.057 52.023 205.057" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M439.82 194.421 546.843 399.484" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M462.82 194.424 623.844 399.493" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M485.82 194.426 699.727 400.248" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M507.82 194.429 773.844 399.51" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M532.82 194.432 793.839 362.588" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M550.82 194.434 793.835 326.59" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M573.82 194.436 793.832 300.223" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M597.82 194.439l196.01 83.156" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M618.82 194.442l175.008 65.906" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M640.82 194.444l153.006 51.093" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M661.82 194.447l132.005 39.408" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M681.82 194.449l112.004 30.77" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M703.82 194.451 793.823 217.017" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M722.82 194.454l71.002 15.393" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M740.821 194.456 793.821 202.96" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M757.821 194.458 793.821 197.538" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(0.999999,-0.000112464,-0.00011259,0.97537,6.20178,10.4171)"><path d="M773.821 194.46 793.821 194.462" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M416.82 194.418c17.341 68.353 52.023 205.057 52.023 205.057" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M439.82 194.421 546.843 399.484" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M462.82 194.424 623.844 399.493" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M485.82 194.426 699.727 400.248" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M507.82 194.429 773.844 399.51" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M532.82 194.432 793.839 362.588" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M550.82 194.434 793.835 326.59" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M573.82 194.436 793.832 300.223" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M597.82 194.439l196.01 83.156" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M618.82 194.442l175.008 65.906" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M640.82 194.444l153.006 51.093" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M661.82 194.447l132.005 39.408" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M681.82 194.449l112.004 30.77" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M703.82 194.451 793.823 217.017" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M722.82 194.454l71.002 15.393" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M740.821 194.456 793.821 202.96" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M757.821 194.458 793.821 197.538" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g><g transform="matrix(-0.999999,-0.000112464,0.00011259,0.97537,793.798,10.4171)"><path d="M773.821 194.46 793.821 194.462" style="fill:none;stroke:#ff00a6;stroke-width:2.03px"/></g></g><g id="horizontals"><path d="M0 365 8e2 365.024" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 328H8e2" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M8e2 302H0" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 280H8e2" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M8e2 263.6.0 263.843" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 249.563 8e2 249.576" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 237.737 8e2 237.846" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 230H8e2" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M-.092 222H8e2" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 215 8e2 214.978" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M.149 209H8e2" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><path d="M0 203H8e2" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/><g transform="matrix(1,0,0,1,0,-1)"><path d="M0 2e2H8e2.0z" style="fill:none;stroke:#8a8ac9;stroke-width:1px"/></g></g></g></svg><div class="main-wrapper main-wrapper--subpage"><main class=main-content><article class=post><div class="tag-list__list styled-font"></div><header><h1 class="styled-font page-title">How to debug dependencies in Go projects</h1></header><p class=post__date>June 19, 2024</p><h2 id=debugging-dependencies>Debugging dependencies</h2><p>If you want to debug how a dependency is used in a Go project run <code>go mod vendor</code> to download all your projects dependencies to a <code>vendor</code> folder in your project. You can then add breakpoints to the vendored code just like your project code.</p><h2 id=replacing-dependencies-with-your-forks>Replacing dependencies with your forks</h2><p>If you&rsquo;re working on a contribution to a dependency (for example fixing a bug you&rsquo;ve discovered) then you might want to test that out locally with your project. To do this you can use the <code>replace</code> keyword in your go.mod file.</p><p>Today I wanted to test a change to how sweepers are filtered in the hashicorp/terraform-plugin-sdk module, as part of my work on the Google Terraform provider. The snippet below shows how I replaced use of <code>hashicorp/terraform-plugin-sdk</code> with my fork of that module containing a change. In the go,mod file I specify a commit containing an idea for a contribution/bug fix (<a href=https://github.com/SarahFrench/terraform-plugin-sdk/commit/d188bcc3c75e66bd775b98fc512a5706ccf930e8 rel="noopener noreferrer nofollow" target=_blank>d188bcc</a>). That commit SHA is used below:</p><pre tabindex=0><code>module github.com/hashicorp/terraform-provider-google-beta

go 1.21

require (
  ...
	github.com/hashicorp/terraform-plugin-sdk/v2 v2.33.0
  ...
)

// Use my fork of the hashicorp/terraform-plugin-sdk repository instead
replace github.com/hashicorp/terraform-plugin-sdk/v2 =&gt; github.com/SarahFrench/terraform-plugin-sdk/v2 d188bcc3c75e66bd775b98fc512a5706ccf930e8
</code></pre><p>After a quick <code>go mod tidy</code> this is changed to a valid reference, which in my case seems to take advantage of exissting tags in the repository; your milage may vary:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#f55>- replace github.com/hashicorp/terraform-plugin-sdk/v2 =&gt; github.com/SarahFrench/terraform-plugin-sdk/v2 d188bcc3c75e66bd775b98fc512a5706ccf930e8
</span></span></span><span style=display:flex><span><span style=color:#f55></span><span style=color:#50fa7b;font-weight:700>+ replace github.com/hashicorp/terraform-plugin-sdk/v2 =&gt; github.com/SarahFrench/terraform-plugin-sdk/v2 v2.34.1-0.20240619163930-d188bcc3c75e
</span></span></span></code></pre></div><h2 id=debugging-the-replaced-dependencies>Debugging the replaced dependencies</h2><p>After adding <code>replace</code> to your go.mod file you can run <code>go mod vendor</code> again. In the vendor folder the directory structure will use the replaced dependency&rsquo;s name (vendor/github.com/hashicorp/terraform-plugin-sdk/&mldr; in my case) but the actual code inside will be the contents of your fork!</p><p>Using these steps I was able to find my contribution&rsquo;s regex needed to be <a href=https://github.com/SarahFrench/terraform-plugin-sdk/commit/8de2d85fb5cb52931e835c9bfe848737a492ecf0 rel="noopener noreferrer nofollow" target=_blank>updated to account for a suffix present on sweeper names</a>, which is used internally by the SDK code.</p></article></main></div><footer class=footer><p class=footer__text>© 2022, Built with <a class=underline href=https://gohugo.io/ rel="noopener noreferrer nofollow" target=_blank>Hugo</a></p></footer></body></html>